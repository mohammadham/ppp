# Summary: Medical Image Encryption Using Chaotic Algorithms and Deep Learning

## Bibliographic Information
- **Title:** Medical Image Encryption Using Chaotic Algorithms and Deep Learning
- **Authors:** Zainab S. Husamuldeen, Tariq M. Salman, Abbas Miry
- **Affiliation:** Department of Electrical Engineering, Mustansiriyah University, Iraq
- **Keywords:** Image encryption, Metadata, Deep learning, Chaotic maps, ResNet-18, MobileNetV2, AES, RSA

---

## Abstract
Medical image encryption is essential for safeguarding patient privacy and confidentiality. This paper presents an innovative methodology that integrates chaotic systems with deep learning to protect medical images from attacks. Four encryption approaches are proposed using 1D (Logistic) and 3D (Lorenz) chaotic maps combined with ResNet-18 and MobileNetV2 deep learning models. The approach assigns a unique key to each image by training a deep learning network to extract chaotic parameters from metadata (EXIF data), reducing key reutilization. The method was assessed on various medical imaging modalities (CT scans, X-rays, MRI, Fundus images), achieving superior security metrics: NPCR of 99.62%, UACI of 39.4%, and entropy of 8.

---

## Key Innovation
**Metadata-Driven Dynamic Key Generation:** Unlike existing approaches using static or randomly generated keys, this methodology derives encryption keys directly from medical image EXIF metadata, making keys dynamic, context-sensitive, and image-dependent.

---

## Methodology

### 1. Chaotic Systems

#### A. Logistic Map (1D Discrete)
- **Equation:** $X_t = rX_{t-1}(1 - X_{t-1})$
- **Control Parameter:** r ∈ [3.57, 4]
- **State Element:** $X_{t-1} \\in (0, 1)$
- **Properties:** Pseudo-random, unpredictable, highly sensitive to initial values

#### B. Lorenz Map (3D Continuous)
- **Equations:**
  - $dx/dt = σ(y - x)$
  - $dy/dt = ρx - y - xz$
  - $dz/dt = xy - βz$
- **Parameters:** σ (Prandtl number), ρ (Rayleigh number), β (direction ratio)
- **Properties:** Complex, unexpected behavior, time-dependent evolution

### 2. Deep Learning Models

#### A. ResNet-18 (Residual Network-18)
- **Architecture:** 18 layers, 8 residual blocks (each with two 3×3 convolutional layers)
- **Input Size:** 224×224×3
- **Key Features:**
  - Residual connections (skip connections) for enhanced gradient propagation
  - Mitigates vanishing gradient problem
  - More efficient than deeper ResNet variants

#### B. MobileNetV2
- **Design:** Lightweight CNN for mobile and embedded applications
- **Key Features:**
  - Inverted residuals and linear bottlenecks
  - Depthwise separable convolutions (reduced computing expenses)
  - ReLU6 activation for low-bit hardware
  - Optimized for edge devices with reduced parameters

### 3. Encryption Algorithms

#### A. RSA (Asymmetric)
- **Key Generation:**
  1. Choose two large prime numbers p and q
  2. Calculate N and Euler's totient function Φ(N)
  3. Determine encryption key e: 1 < e < Φ(N), gcd(e, Φ(N)) = 1
  4. Calculate decryption key d: ed ≡ 1 (mod Φ(N))
- **Encryption:** $C = M^e \\text{ mod } N$
- **Decryption:** $M = C^d \\text{ mod } N$

#### B. AES (Symmetric)
- **Standards:** FIPS-197 (2001)
- **Key Lengths:** 128, 192, or 256 bits
- **Block Size:** 128 bits
- **Rounds:** 10, 12, or 14 (depending on key length)
- **Transformations:**
  1. SubBytes: Substitutes bytes via Rijndael S-box
  2. ShiftRows: Cyclically shifts rows
  3. MixColumns: Polynomial multiplication
  4. AddRoundKey: Bitwise XOR with round key

---

## Proposed Encryption Framework

### Four Techniques Evaluated:
1. Logistic Map + ResNet-18
2. Logistic Map + MobileNetV2
3. Lorenz Map + ResNet-18
4. Lorenz Map + MobileNetV2

### Encryption Process Steps:

#### Phase 1: Key Generation
1. **Metadata Extraction:** Extract EXIF data (date, time) from medical image
2. **Metadata Transformation:** Convert metadata into image format for neural network
3. **Neural Network Training:** Train DL model to correlate metadata with chaotic parameters
4. **Chaotic Parameter Generation:** Generate parameters from trained model
5. **Chaotic Sequence Generation:** Use chaotic maps with generated parameters to produce three sequences (xkey, ykey, zkey)

#### Phase 2: Image Encryption
6. **Permutation:**
   - Sort row indices using xkey → xindex
   - Sort column indices using ykey → yindex
   - Shuffle rows using yindex
   - Shuffle columns using xindex
7. **Diffusion:** XOR scrambled image with zkey
8. **Key Encryption (Hybrid AES-RSA):**
   - Combine all keys (xindex, yindex, zkey) in one file
   - Generate RSA public key (e, N)
   - Generate random 128-bit AES key
   - Encrypt key file using AES
   - Encrypt AES key using RSA public key

### Decryption Process Steps:
1. Receive encrypted image and keys
2. Decrypt AES key using RSA private key (d, N)
3. Decrypt key file using AES key
4. Restore pixel values: XOR encrypted image with zkey (reverse diffusion)
5. Calculate reverse matrices (inv_xindex, inv_yindex)
6. Restore pixel locations:
   - Reinstate column order using inv_xindex
   - Reinstate row order using inv_yindex
7. Output decrypted image

---

## Experimental Setup

### Datasets:
- **Sources:** NIH, DRIVE image collection, Chest X-ray images (Pneumonia), Brain Tumor MRI
- **Modalities:** CT scans, X-rays, MRI, Fundus images
- **Image Sizes:** 339×509, 702×701, 2124×2056, 581×476 pixels

---

## Security Analysis Results

### 1. NPCR (Number of Pixels Change Rate)
- **Definition:** Measures variations between images before and after encryption
- **Maximum Value:** 100%
- **Formula:** $\\text{NPCR} = \\frac{\\sum_{i,j} |C_1(i,j) - C_2(i,j)|}{S} \\times 100\\%$
- **Results:** Average **99.62%** (near-optimal)
- **Interpretation:** Enhanced resilience against differential attacks

### 2. UACI (Unified Average Changing Intensity)
- **Definition:** Average variance between original and encrypted images
- **Ideal Range:** 30-35%
- **Formula:** $\\text{UACI} = \\frac{\\sum_{i,j} |C_1(i,j) - C_2(i,j)|}{M \\times N} \\times 100\\%$
- **Results:** Up to **39.4%** (Sample 4 with Logistic+ResNet)
- **Interpretation:** Robust protection against known-plaintext and chosen-plaintext attacks

### 3. Correlation Coefficient
- **Formula:** $r = \\frac{\\text{Covariance}(x,y)}{S_x S_y}$
- **Ideal Value:** Close to 0 (no relationship between neighboring pixels)
- **Results:** All values between -0.0075 and 0.0091 (near-zero)
- **Directions Tested:** Horizontal, vertical, diagonal
- **Interpretation:** Minimal inter-pixel dependency, resistant to statistical attacks

### 4. Information Entropy
- **Formula:** $H(m) = -\\sum_{i=1}^{L} P(m_i) \\log_2 P(m_i)$
- **Ideal Value:** 8 bits
- **Results:** **7.9995 to 8.0000 bits** (near-optimal)
- **Interpretation:** High randomness, uniform pixel distribution, resistant to statistical attacks

### 5. MSE (Mean Square Error)
- **Formula:** $\\text{MSE} = \\frac{1}{M \\times N} \\sum_{x=0}^{M-1} \\sum_{y=0}^{N-1} [f_p(x,y) - f_r(x,y)]^2$
- **Between Original and Decrypted:** **0** (perfect reconstruction)
- **Between Original and Encrypted:** 7870-14816 (high values indicate strong encryption)

### 6. PSNR (Peak Signal-to-Noise Ratio)
- **Formula:** $\\text{PSNR} = 20 \\log_{10}\\left(\\frac{K}{\\sqrt{\\text{MSE}}}\\right)$
- **Between Original and Decrypted:** **∞** (perfect quality)
- **Between Original and Encrypted:** 6.42-9.18 dB (low values indicate effective encryption)
- **Acceptable Range for Encryption:** Below 10 dB

### 7. Key Space Analysis
- **Formula:** 
  - Key size (bits) = $(L_{xindex} + L_{yindex} + L_{zkey}) \\times 8$
  - Key space = $2^{\\text{Key size}}$
- **Example (128×128 image):** Key space ≈ $2^{133120}$ (much larger than $2^{128}$)
- **NIST SP 800-22 Test Result:** Effective key entropy = 7.9864 bits (near theoretical limit of 8)
- **Interpretation:** Makes brute-force attacks computationally infeasible

---

## Comparative Analysis

### Execution Time (seconds):
| Method | Image Size | Encryption | Decryption |
|--------|-----------|------------|------------|
| Proposed | 256×256 | 0.7914 | 0.8669 |
| Proposed | 512×512 | 1.8107 | 1.9592 |
| Ref [18] | 256×256 | 0.1037 | 0.0984 |
| Ref [18] | 512×512 | 0.3036 | 0.2743 |

**Note:** While slightly slower than some methods, the proposed approach offers superior security.

### Best Configuration: Logistic Map with ResNet-18
- Highest overall performance across all metrics
- Optimal balance between lightweight chaotic system and deep residual network
- Superior NPCR, UACI, and entropy values

---

## Key Contributions

1. **Metadata-Driven Key Generation:**
   - Unique keys for each image
   - Dynamic, context-sensitive encryption
   - Prevents key reuse vulnerabilities

2. **Deep Learning-Guided Chaos Parameter Generation:**
   - DL models examine metadata and provide optimal parameters
   - Introduces uncertainty and amplifies sensitivity
   - Adaptive feature processing

3. **Hybrid Chaotic-DL Encryption Framework:**
   - Combines velocity and unpredictability of chaotic systems
   - Leverages adaptive feature processing of deep learning
   - More sophisticated and secure than traditional methods

4. **Comprehensive Multi-Modal Assessment:**
   - Tested on CT, X-ray, MRI, and fundus images
   - Demonstrates robustness across diverse modalities

5. **Enhanced Security Metrics:**
   - NPCR, UACI, and entropy surpass most contemporary methods
   - Low correlation coefficients
   - Large key space

---

## Robustness Against Attacks

### 1. Brute-Force Attacks
- **Protection:** Extremely large key space ($2^{133120}$ for 128×128 images)
- **Conclusion:** Computationally infeasible

### 2. Known-Plaintext Attacks
- **Protection:** High UACI values (>30%), unique keys per image
- **Conclusion:** Robust protection

### 3. Chosen-Plaintext Attacks
- **Protection:** Dynamic metadata-driven keys, image-specific encryption
- **Conclusion:** Strong resistance

### 4. Statistical Attacks
- **Protection:** High entropy (≈8), near-zero correlation, uniform histograms
- **Conclusion:** Resistant to pattern analysis

### 5. Differential Attacks
- **Protection:** High NPCR (≈99.62%), strong avalanche effect
- **Conclusion:** Minor input changes cause major output differences

---

## Advantages

1. **Dynamic Security:** Each image gets a unique key based on its metadata
2. **No Key Reuse:** Eliminates vulnerabilities from static keys
3. **Context-Sensitive:** Encryption adapts to image-specific properties
4. **Multi-Modal:** Works across different medical imaging modalities
5. **Theoretical Foundation:** Combines chaos theory's unpredictability with DL's adaptability
6. **Scalable Key Space:** Increases with image resolution
7. **Strong Confusion & Diffusion:** Achieves cryptographic goals effectively

---

## Limitations and Considerations

1. **Execution Time:** Slightly longer than some lightweight methods (trade-off for security)
2. **Metadata Dependency:** Requires EXIF data or manual input
3. **Computational Resources:** Deep learning models require training
4. **Decryption Process:** Keys must be transmitted securely via AES/RSA
5. **Hardware Requirements:** May need optimization for resource-constrained environments

---

## Future Research Directions

1. **Hardware Acceleration:** GPU optimization for faster processing
2. **Advanced DL Architectures:** Testing with newer models
3. **Energy Efficiency:** Optimization for edge devices
4. **Formal Security Proofs:** Mathematical verification of security claims
5. **Real-World Deployment:** Integration with PACS systems
6. **Key Management Infrastructure:** Blockchain or distributed ledger integration
7. **Extension to Other Data Types:** Audio and video encryption
8. **Alternative Chaotic Systems:** Exploring more complex maps

---

## Conclusions

This research introduced an innovative medical image encryption approach combining deep learning with chaotic systems. The metadata-driven key generation ensures each image produces a distinct encryption key, preventing key reuse and enhancing resilience against attacks.

**Key Findings:**
- Logistic Map with ResNet-18 achieved superior performance
- NPCR above 99.62%, UACI surpassing 36.3%
- PSNR below 10 dB, high MSE values
- Theoretical key space of $2^{133120}$ for 128×128 images
- Robust against statistical, differential, brute-force, and plaintext attacks

**Impact:**
- Introduces novel integration of ML with chaos-based encryption
- Applicable to secure medical imaging and potentially other data formats
- Opens new avenues for context-sensitive, dynamic encryption systems
