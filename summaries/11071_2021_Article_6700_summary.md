# Summary: Steganography-based Voice Hiding in Medical Images of COVID-19 Patients

## Bibliographic Information
- **Title:** Steganography-based voice hiding in medical images of COVID-19 patients
- **Author:** Melih Yildirim
- **Journal:** Nonlinear Dynamics (2021) 105:2677-2692
- **DOI:** https://doi.org/10.1007/s11071-021-06700-z
- **Publication Date:** July 22, 2021
- **Publisher:** Springer Nature B.V.

---

## Abstract
This research proposes a novel image steganography technique to hide encrypted voice comments of doctors related to COVID-19 patients within medical images. The technique is based on chaos theory, utilizing a delay-introducing method-based logistic chaotic map. The doctor's voice comments are first converted into an image, then encrypted using the proposed chaotic system-based encryption algorithm, and finally embedded into a lung angiography dual-energy computed tomography (CT) scan using an LSB-based method.

---

## Research Objectives
1. Develop a novel steganography technique for securely hiding doctor's voice comments in medical images
2. Protect patient information by encrypting and embedding voice data within medical images
3. Ensure robustness against various security attacks (differential, statistical, exhaustive, known plaintext, chosen plaintext)
4. Maintain visual quality of medical cover images after data embedding

---

## Methodology

### 1. Chaotic System Foundation
**Delay-Introducing Method-based Logistic Chaotic Map:**

$$X_{i+1} = FL((bx_{i-1} + 4 - b)x_i(1 - x_i))$$

Where:
- Initial values: $x_0 = 0.1$ and $x_1 = 0.2$
- Parameter $b \in (0, 0.4)$
- FL represents the precision function
- Values scaled to range [0, 255]: $X_{i+1} = \text{floor}(\text{mod}(x_{i+1} \times 10^5, 256))$

### 2. Steganography Algorithm Steps

#### Step 1: Converting Audio Data to Pixel Value
- 8-bit audio samples ranging from -128 to 127 are converted to pixel values (0-255)
- Each audio sample becomes one pixel value using binary representation:
  $$B(i) = s_7 \times 2^7 + s_6 \times 2^6 + ... + s_1 \times 2^1 + s_0 \times 2^0$$

#### Step 2: Pseudorandom Pixel Placement (Algorithm 1)
- A blank image (all zeros) is created with dimensions matching the cover image
- Converted pixel values are placed randomly using pseudorandom coordinates generated by the chaotic system
- Coordinates array produced using XOR operations on chaotic sequences X, Y, Z

#### Step 3: Logical XOR Operation (Algorithm 2)
- Key R(p) is generated from the chaotic map
- Logical XOR operation is performed: C = C ⊕ R

#### Step 4: XOR for Sequential Bits (Algorithm 3)
- Sequential XOR operations performed from LSB to MSB
- Each bit is XORed with its adjacent bit
- Example: [10010110] → [01110010]

#### Step 5: Complement and Swap (Algorithm 4)
- Count bits equal to one in each pixel
- If count is odd: perform one's complement operation
- If count is even: perform four-bit swapping operation (swap first 4 bits with last 4 bits)
- Enhances resistance to differential attacks

#### Step 6: XOR Operation with Next Pixel (Algorithm 5)
- Each pixel C(p) is XORed with the chaotic key S(p)
- Then XORed with the next pixel C(p+1)
- Operation performed bidirectionally (C(1) to C(N) and C(N) to C(1))
- Ensures any change in one pixel affects all pixels

#### Step 7: Data Hiding based on LSB Method (Algorithm 6)
- Cover image: RGB lung angiography CT scan (512×512 or 1024×1024 pixels)
- Encrypted audio data embedded as follows:
  - First 3 bits of encrypted pixel → Last 3 bits of Red component
  - Next 3 bits → Last 3 bits of Green component
  - Last 2 bits → Last 2 bits of Blue component

### 3. Decoding Process
- Exact reverse of the 10 encoding steps
- Requires correct initial conditions and secret keys from chaotic system

---

## Experimental Results

### Visual Quality Analysis (512×512 pixels)

**Similarity Metrics between Cover and Stego Images:**

| Component | SSIM   | MSE     | RMSE   | MAE    | PSNR    |
|-----------|--------|---------|--------|--------|----------|
| Red       | 0.8337 | 10.9875 | 3.3147 | 2.6856 | 37.7218 |
| Green     | 0.7926 | 10.2826 | 3.2066 | 2.5981 | 38.0098 |
| Blue      | 0.9273 | 2.5263  | 1.5894 | 1.2556 | 44.1060 |

**Key Observations:**
- Blue component shows highest SSIM (embeds only 2 bits vs. 3 bits for R and G)
- Stego image visually similar to cover image
- Histograms remain relatively close
- Secret audio data successfully recovered from stego image

### Security Analysis Results

#### 1. Differential Attack Analysis

**NPCR (Number of Pixels Change Rate) & UACI (Unified Average Changing Intensity):**
- Average NPCR: **99.8069%** (10 samples)
- Average UACI: **33.5688%** (10 samples)

**Effect of Algorithms 3, 4, 5:**
- **With algorithms:** NPCR = 99.7074%, UACI = 33.5321%
- **Without algorithms:** NPCR = 0.0004%, UACI = 0.000001%
- Demonstrates critical importance of these algorithms for differential attack resistance

#### 2. Statistical Attack Analysis

**Histogram Analysis:**
- Encrypted audio data shows uniformly distributed histogram
- Indicates good confusion properties
- Resistant to statistical pattern recognition

**Correlation Coefficient Analysis (512×512 pixels):**

| Direction  | Encrypted Image | Cover Image | Stego Image |
|------------|-----------------|-------------|--------------|
| Diagonal   | 0.0023          | 0.9738      | 0.9722       |
| Horizontal | 0.0027          | 0.9830      | 0.9814       |
| Vertical   | 0.0045          | 0.9893      | 0.9877       |

- Correlation in encrypted image nearly zero (ideal for security)
- Spatial redundancy effectively removed

**Information Entropy:**
- Calculated value: **7.9993 bits**
- Ideal value: 8 bits
- Indicates uniform pixel distribution and high randomness
- Demonstrates resistance to statistical attacks

#### 3. Initial Condition Sensitivity Analysis
- System precision: 10⁻¹⁶
- A change of 10⁻¹⁶ in parameter b produces completely different decrypted output
- Confirms sensitive dependence on initial conditions (characteristic of chaotic systems)
- Provides resistance against exhaustive attacks

#### 4. Known Plaintext and Chosen Plaintext Attacks
- High sensitivity to initial conditions prevents these attacks
- Enhanced XOR operations create complex dependencies between bits and pixels
- Each pixel's encrypted value depends on both its own value and subsequent pixel values

---

## Comparative Analysis

### Comparison with Previous Algorithms:

| Study      | NPCR (%) | UACI (%) | Entropy |
|------------|----------|----------|----------|
| [24]       | 98.465   | 35.8008  | 7.9990   |
| [37]       | 99.61    | 33.47    | 7.9993   |
| [39]       | 99.2453  | 36.4973  | 7.9970   |
| **This study** | **99.8069** | **33.5688** | **7.9993** |

- This study achieves **highest NPCR** among compared methods
- UACI and Entropy values competitive with state-of-the-art

---

## Key Contributions

1. **Novel Encryption Scheme:**
   - XOR operation for sequential bits (Algorithm 3)
   - Complement and four-bit swapping based on bit count (Algorithm 4)
   - XOR operation with next pixel (Algorithm 5)

2. **Differential Attack Resistance:**
   - Previous steganography studies [1, 6, 23] did not address differential attacks
   - This study provides comprehensive differential attack analysis and resistance

3. **Medical Data Privacy:**
   - Addresses critical need for HIPAA compliance and patient privacy
   - Enables secure transmission of doctor's voice comments with medical images

4. **Scalability:**
   - Capacity can be extended with larger cover images or lower audio quality
   - Example: >1 hour audio in 2048×2048 pixel image with 8× downsampling

---

## Strengths

1. **Comprehensive Security Analysis:**
   - Differential attack, statistical attacks, initial condition sensitivity
   - Known plaintext and chosen plaintext attack resistance

2. **Strong Theoretical Foundation:**
   - Based on chaos theory with proven unpredictability
   - Delay-introducing method counteracts dynamical degradation

3. **Practical Application:**
   - Directly addresses COVID-19 patient data privacy needs
   - LSB-based method simpler than transform domain techniques

4. **Quantifiable Results:**
   - All metrics clearly defined and measured
   - Comparative analysis with previous work

5. **Visual Quality Preservation:**
   - Minimal impact on medical image quality (critical for diagnosis)
   - SSIM values indicate acceptable similarity

---

## Limitations and Considerations

1. **Key Management:**
   - Secure distribution of initial conditions and parameters not detailed
   - Critical for practical implementation

2. **Computational Complexity:**
   - Multiple encryption steps may increase processing time
   - Not quantified in the study

3. **Capacity Analysis:**
   - Detailed quantitative analysis of embedding capacity across different image sizes needed
   - Dependency on audio quality and cover image size mentioned but not thoroughly explored

4. **Generalizability:**
   - Tested on specific CT scan type
   - Performance on other medical imaging modalities (X-ray, MRI, ultrasound) not verified

5. **Transmission Robustness:**
   - Decoding efficiency and noise resistance during transmission not explicitly detailed

6. **System Precision Constraint:**
   - Changes smaller than 10⁻¹⁶ in initial conditions won't affect the output
   - Defines the security boundary of the system

---

## Technical Implementation Details

### Parameters Used:
- Chaotic map parameter b = 0.1, 0.2, 0.3 (for generating X, Y, Z sequences)
- Audio bit depth: 8 bits
- Cover image sizes: 512×512 and 1024×1024 pixels
- Audio sample: 1 second, 8 kHz sample rate

### Software:
- MATLAB environment for all numerical and security analyses

### Cover Image:
- Lung angiography dual-energy CT scan of COVID-19 patient
- RGB color image
- Source: Reference [30]

---

## Conclusions

The paper successfully demonstrates:

1. **Effective Encryption:** Chaotic system-based encryption provides strong security for audio data before embedding

2. **Robust Steganography:** LSB-based embedding maintains visual quality while hiding encrypted data

3. **Strong Security:** 
   - Resistant to differential attacks (NPCR: 99.8069%, UACI: 33.5688%)
   - Resistant to statistical attacks (Entropy: 7.9993 bits, near-zero correlations)
   - Resistant to exhaustive attacks (high sensitivity to initial conditions)
   - Resistant to known/chosen plaintext attacks

4. **Medical Relevance:** Addresses real-world need for patient data privacy in COVID-19 context

5. **Superior Performance:** Achieves highest NPCR value compared to similar studies

---

## Applications

- **Telemedicine:** Secure transmission of medical images with voice annotations
- **Electronic Health Records:** Privacy-preserving storage of doctor's comments
- **Medical Consultations:** Safe sharing of diagnostic images with expert opinions
- **HIPAA Compliance:** Meeting regulatory requirements for patient data protection
- **COVID-19 Patient Management:** Specific application demonstrated in this study

---

## Future Research Directions

1. Extension to other medical imaging modalities
2. Real-time implementation and performance optimization
3. Detailed key management protocol development
4. Robustness testing under network noise and compression
5. Capacity-security trade-off analysis
6. Hardware implementation (FPGA/ASIC) for faster processing
7. Integration with existing medical information systems

---

## Keywords
COVID-19, Steganography, Cryptography, Chaos Theory, Voice Hiding, Differential Attack, Statistical Attacks, Medical Image Security, LSB Method, Logistic Chaotic Map, Patient Privacy, Healthcare Data Protection