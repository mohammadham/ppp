# Enhanced security for medical images using a new 5D hyper chaotic map and deep learning based segmentation

## Article Metadata
- **Authors**: S. Subathra & V. Thanikaiselvan
- **Journal**: Scientific Reports (Nature)
- **Year**: 2025
- **DOI**: s41598-025-04906-4

---

## Abstract Summary

This research proposes a novel medical image encryption method combining a **New 5D hyperchaotic system** with a **customized U-Net architecture** for critical region segmentation. The significant region extracted from medical images is used to generate dynamic encryption keys, which serve as initial conditions for the 5D hyperchaotic map. The encryption algorithm employs:

1. **Zig-zag scrambling** for pixel position confusion
2. **New 5D hyperchaotic permutation** for further scrambling
3. **Two-stage diffusion**: Dynamic DNA flip and dynamic DNA XOR

**Key Results**:
- Average correlation coefficients: Horizontal (-0.0018), Vertical (-0.0002), Diagonal (0.0007)
- Shannon entropy: 7.9971
- Kolmogorov Entropy: 2.9469
- NPCR: 99.61%
- UACI: 33.49%
- Chi-square: PASS at both 5% (293.2478) and 1% (310.4574) significance levels
- Key space: 2⁵⁰⁰
- Encryption time: ~2.93 seconds per 256×256 image

---

## 1. Introduction & Motivation

### Background
- Digital healthcare infrastructure increasingly relies on medical imaging (remote surgical assistance, image-based diagnosis, real-time health monitoring)
- Security concerns in medical image transmission due to sensitive patient data
- Traditional encryption methods ineffective for medical images due to high redundancy and massive pixel density

### Key Challenges
- Medical images require secure transmission ensuring privacy, integrity, and dependability
- Conventional encryption techniques:
  - Resource-intensive
  - Lack scalability for multimedia datasets
  - Vulnerable to custom-plaintext and data analysis attacks
- Need for lightweight, robust encryption suitable for healthcare IoT platforms

### Proposed Solution
- Integration of **U-Net deep learning segmentation** with **novel 5D hyperchaotic system**
- U-Net segments critical regions (anatomical structures, tumors, vessels) for key generation
- 5D hyperchaotic system generates unique random sequences using segmented region statistics
- Two-stage permutation + diffusion with dynamic DNA encoding

---

## 2. Literature Survey

### Medical Image Encryption Methods Reviewed
1. **Chaotic map-based approaches**:
   - 1D Cosine-within-Sine (1D-CwS) chaotic map
   - Elliptic Curve Cryptography (ECC) with Blum-Goldwasser Cryptosystem
   - 2D Cosine-Sine map with dynamic DNA for medical video encryption
   
2. **Hybrid approaches**:
   - Rubik's cube-based bit-plane shuffling with logistic map
   - Dual-image encryption using chaotic phase Fresnel diffraction
   - Biometric image as key with fractional trigonometric chaotic map
   
3. **Memristor-based approaches**:
   - Non-volatile CMOS memristor arrays for encryption
   - Memristive FN-HNN neural networks with complex dynamics
   - LSTM-based memristive arrays for fault diagnosis

### Medical Hyperchaotic Encryption
- 6D high-dimensional chaotic system with DNA encoding
- 5D hyperchaotic system with Hybrid Random Matrix Transform (HRMT)
- Fisher-Yates confusion with Chen chaotic system and DNA operations
- 6D chaotic map with random signal insertion
- 3D/4D hyperchaotic maps with wavelet transform and DNA encoding

### Research Gaps Identified
- Existing methods susceptible to complex attacks
- High computational complexity
- Limited capacity for handling big datasets
- Difficulties in real-time health information systems

---

## 3. Proposed Methodology

### 3.1 New 5D Hyperchaotic System

**System Equations**:

$$
\begin{aligned}
\frac{dx}{dt} &= \gamma(y-x) + \kappa y + z \\
\frac{dy}{dt} &= x - \delta y - xz^2 + yz \\
\frac{dz}{dt} &= -\beta z + x^2 + xy + \kappa z \\
\frac{du}{dt} &= \epsilon y + vu^a \\
\frac{dv}{dt} &= \rho u + \kappa v + z
\end{aligned}
$$

**Control Parameters**:
- α = 40, β = 8, γ = 40, d = 1, ε = −0.5, ρ = -0.5, p = 25.5, k = 0.05

**Lyapunov Exponents**:
- λ₁ = 19.3889 (positive - hyperchaotic)
- λ₂ = 4.7545 (positive)
- λ₃ = 0.3866
- λ₄ = -0.5982
- λ₅ = -44.4191

**Kolmogorov Entropy**: 2.9469 (highest among compared methods, indicating superior unpredictability)

**NIST SP 800-22 Test**: All five chaotic sequences (x, y, z, u, v) **passed all 16 randomness tests**

---

### 3.2 Customized U-Net Architecture

**Purpose**: Segment critical regions from medical images for dynamic key generation

**Architecture Details**:
- **Input**: Grayscale medical image (256×256)
- **Encoder**: 3 blocks with double-stacked 3×3 convolutions (64, 128, 256 filters) + ReLU + Max Pooling
- **Bottleneck**: 2×3×3 Convolution (512 filters) + ReLU
- **Decoder**: 3 blocks with up-sampling + skip connections + convolutions
- **Output**: 1×1 Convolution + Sigmoid (binary segmentation mask)

**Training Setup**:
- Optimizer: Adam
- Loss: Binary cross-entropy
- Epochs: 200 (early stopping with patience=10)
- Batch size: 8
- Validation split: 20%

**Datasets Used**:
- RITE (Retinal Images for Vessel Extraction) - 80 training, 10 test images
- DRIVE (Digital Retinal Images for Vessel Extraction) - 20 test images
- BRATS2020 (Brain tumor segmentation)
- Breast Ultrasound Images Dataset
- GlaS (Gland segmentation dataset)
- Chest X-ray dataset

**Performance Metrics** (Table 4):
- U-Net: Accuracy=0.9606, Precision=0.8046, Recall=0.7547, F1-score=0.7789, IoU=0.6821, Dice=0.8110
- Comparison with ResU-Net and Attention U-Net shows optimal balance between quality and efficiency

**Advantages of U-Net for Encryption**:
1. Each image generates unique initial conditions from critical regions
2. High segmentation accuracy with reduced computing overhead
3. Works well on small datasets
4. Single preprocessing step with lowest computational cost
5. 25-35% faster inference than Attention U-Net

---

### 3.3 Key Generation Process

**Statistical Features from Segmented Region**:

1. **Key Kx (Sum of pixel values)** - overall brightness:
   $$k_x = \sum_{i=1}^{R} \sum_{j=1}^{C} I_1(i,j)$$

2. **Key Ky (Skewness)** - asymmetry in intensity distribution:
   $$K_y = \frac{1}{M \times N} \sum_{i=1}^{R} \sum_{j=1}^{C} \left( \frac{I_1(i,j) - E}{\sigma_a} \right)^3$$

3. **Key Kz = Kx + Ky** - combined brightness and contrast

4. **Key Kω (Kurtosis)** - concentration around mean:
   $$K_\omega = \frac{1}{M \times N} \sum_{i=1}^{R} \sum_{j=1}^{C} \left( \frac{I_1(i, j) - E}{\sigma_a} \right)^4 - 3$$

**Initial Conditions Assignment**:
- x₀ = key_xo
- y₀ = key_yo
- z₀ = key_zo
- u₀ = key_wo
- v₀ = key_zo

**Example** (Drive test image-1):
- x₀ = -0.5, y₀ = -1.5, z₀ = -0.5, u₀ = -1.5, v₀ = -0.5

---

### 3.4 Encryption Algorithm

**Step 1: Zig-Zag Scrambling**
- Confuses pixel positions through zig-zag pattern traversal
- Multiple iterations for enhanced confusion

**Step 2: Permutation with 5D Chaotic Sequence**
- Uses sorted indices from chaotic sequence for pixel rearrangement
- Further obfuscates image structure

**Step 3: Dynamic DNA Encoding**
- Each pixel converted to 8-bit binary
- Binary values encoded to DNA bases (A, T, G, C) using 8 DNA rules
- DNA rule selection based on mod 8 of chaotic values
- Center location (mod 4) determines encoding operation

**DNA Rules** (8 variations, e.g., Rule 1):
- 00 → A, 11 → T, 10 → G, 01 → C

**Step 4: Dynamic DNA Flip (First Diffusion)**
- Hyperchaotic sequence V converted to mod 4 for center position
- DNA bases swapped based on center position:
  - P(i,j) = 1: [B₂, B₃, B₄, B₁]
  - P(i,j) = 2: [B₃, B₄, B₁, B₂]
  - P(i,j) = 3: [B₄, B₁, B₂, B₃]
  - P(i,j) = 4: [B₄, B₁, B₂, B₃]

**Step 5: DNA XOR Diffusion (Second Diffusion)**
- Chaotic sequence V converted to DNA format (V_DNA)
- XOR operation between DNA flipped image and V_DNA:
  $$\text{Cipher Image}(i, j) = D'_{DNA}(i, j) \oplus V_{DNA}(i, j)$$
- Uses 16 DNA XOR rules

**Decryption**: Reverse operations with same keys

---

## 4. Experimental Results

### Datasets Tested
- **RITE dataset**: 10 test retinal images
- **DRIVE dataset**: 20 test retinal images
- **Other medical images**: Breast, Gland, Chest, Brain

### Visual Results
- Original images show high structural correlation
- Encrypted images appear completely random (noise-like)
- Histograms of encrypted images show uniform distribution
- Successful decryption with correct keys

---

## 5. Security Analysis

### 5.1 Correlation Analysis

**Original images**: High correlation (>0.98 in all directions)
**Encrypted images**: Near-zero correlation

| Direction | Average Correlation (Encrypted) |
|-----------|--------------------------------|
| Horizontal | -0.0018 |
| Vertical | -0.0002 |
| Diagonal | 0.0007 |

**Significance**: Successfully eliminates relationships between neighboring pixels

---

### 5.2 Histogram Analysis
- Original images: Non-uniform distribution reflecting image structure
- Encrypted images: **Uniform distribution** across all intensity levels
- Provides strong defense against statistical attacks

---

### 5.3 Chi-Square Test

**Results for Different Medical Images**:

| Medical Image | Chi-square Value | Critical Value (5%) | Critical Value (1%) | Result |
|---------------|------------------|---------------------|---------------------|--------|
| Eye | 266.6172 | 293.2478 | 310.4574 | PASS |
| Breast | 238.7999 | 293.2478 | 310.4574 | PASS |
| Gland | 304.1504 | 293.2478 | 310.4574 | PASS |
| Chest | 292.4817 | 293.2478 | 310.4574 | PASS |
| Brain | 277.9814 | 293.2478 | 310.4574 | PASS |

**All encrypted images** show uniform distribution, validating resistance to statistical attacks.

---

### 5.4 Entropy Analysis

**Shannon Entropy**:
- **Theoretical Maximum**: 8.0 (for 8-bit grayscale)
- **Achieved**: 7.9971 average (near-ideal)
- **Original images**: 3.2-7.5 (varied)

**Kolmogorov Entropy**: 2.9469 (highest among compared methods)

**Significance**: High entropy indicates maximum randomness and unpredictability

---

### 5.5 MSE and PSNR

| Metric | Average Value | Significance |
|--------|---------------|--------------|
| MSE | 10,000-17,000 | High distortion from original |
| PSNR | 5.6-8.0 dB | Low signal quality (effective encryption) |

**High MSE + Low PSNR** = Strong encryption with significant visual distortion

---

### 5.6 Differential Attack Analysis

**NPCR (Number of Pixels Change Rate)**:
- **Theoretical ideal**: 99.6094%
- **Achieved**: 99.57%-99.65% across all images
- Tests sensitivity to single-pixel changes in plaintext

**UACI (Unified Average Changing Intensity)**:
- **Theoretical ideal**: 33.46%
- **Achieved**: 33.31%-33.66%
- Measures intensity of pixel value changes

**Interpretation**: Even a 1-bit change in source image causes >99.6% pixels to change with appropriate intensity variations - **strong avalanche effect**.

---

### 5.7 Key Sensitivity Analysis

**Test Setup**: Change key values by 10⁻⁶

**Results**:
- Decryption with wrong key x → **completely noise-like image**
- Decryption with wrong key y → **completely noise-like image**
- **No partial recovery** even with slight key variation

**Key Space**: **2⁵⁰⁰** (far exceeds 2¹²⁸ required to resist brute-force attacks)

**Comparison with Existing Methods**:

| Reference | Key Space |
|-----------|-----------|
| Ref 7 | 2²⁵⁶ |
| Ref 10 | 2¹⁸⁶ |
| Ref 11 | 2³⁰⁶ |
| Ref 18 | 2²⁸⁰ |
| Ref 20 | 2³⁰⁰ |
| Ref 22 | 2¹⁰⁰ |
| Ref 25 | 2²⁵⁶ |
| Ref 42 | 2²⁸⁸ |
| **Proposed** | **2⁵⁰⁰** |

---

## 6. Attack Resistance Analysis

### 6.1 Cropping Attack
**Test**: Removed 5% and 25% of encrypted image (horizontal, vertical, center)

**Results**:
- 5% cropping: Visible recovery with minor distortion
- 25% cropping: Partial recovery with increased noise
- Essential image content preserved despite data loss
- **Demonstrates robustness** to partial data loss attacks

---

### 6.2 Noise Attack
**Test**: Added salt-and-pepper and speckle noise at 1%, 3%, 10% intensity

**Results**:
- **Salt-and-pepper noise** (1%, 3%, 10%): Most source image content remains recognizable
- **Speckle noise** (1%, 3%, 10%): Granular distortion but image structure preserved
- **Conclusion**: Algorithm maintains effectiveness under challenging noise conditions

---

### 6.3 Geometric Attack
**Tests**:
1. Rotation by ±10°
2. Translation by ±10 pixels (both axes)
3. Scaling by 0.8x, 0.9x

**Results**:
- All geometric attacks produce **noise-like decrypted images**
- NPCR >99.6%, UACI >33% for attacked images
- **Strong resistance** - any geometric deviation prevents exact decryption

---

## 7. Performance Comparison

### Comparison Table (vs. Existing Methods):

| Method | H. Corr | V. Corr | D. Corr | Entropy | NPCR | UACI | Key Space |
|--------|---------|---------|---------|---------|------|------|-----------|
| Ref 14 | -0.0073 | -0.0005 | -0.002 | 7.9982 | 99.62 | 33.49 | - |
| Ref 15 | -0.0009 | -0.0009 | -0.0013 | 7.9996 | 99.69 | 33.53 | - |
| Ref 16 | -0.00098 | -0.00042 | -0.00020 | 7.9991 | 99.60 | 50.04 | - |
| Ref 19 | -0.0065 | 0.0026 | -0.0297 | 7.9992 | 99.59 | 33.45 | - |
| Ref 41 | 0.0050 | 0.0090 | 0.0060 | 7.9993 | 99.51 | 25.21 | - |
| Ref 42 | 0.0006 | 0.0006 | 0.0004 | 7.9989 | 99.60 | 33.50 | 2²⁸⁸ |
| **Proposed (RITE)** | **-0.0018** | **-0.0002** | **0.0007** | **7.9971** | **99.61** | **33.49** | **2⁵⁰⁰** |
| **Proposed (DRIVE)** | **-0.0007** | **0.0006** | **0.0004** | **7.9977** | **99.61** | **33.45** | **2⁵⁰⁰** |

**Key Advantages**:
- Consistently low correlation coefficients across all directions
- Near-ideal entropy (close to 8.0)
- Optimal NPCR and UACI (matching theoretical ideals)
- **Largest key space** (2⁵⁰⁰) among compared methods

---

## 8. Computational Complexity & Time Performance

### Computational Complexity

**Segmentation Phase (U-Net)**:
$$\text{Complexity} = O(L \times N^2)$$
- L = number of convolution layers
- N×N = image size (256×256)

**Encryption Phase (5D Hyperchaotic + DNA)**:
$$\text{Complexity} = O(P \log P)$$
- P = number of pixels

**Total Complexity**:
$$O(L \times N^2 + P \log P)$$

### Execution Time

| Process | Platform | Time |
|---------|----------|------|
| U-Net Segmentation | Google Colab (Tesla T4 GPU) | 0.03 s |
| Encryption | Dell i5 CPU (MATLAB) | 2.9 s |
| **Total** | **Cross-platform** | **2.93 s** |

**Notes**:
- Segmentation performed **once offline** per image for key generation
- Suitable for **real-time medical applications**
- Can be optimized for embedded platforms (NVIDIA Jetson Nano, Raspberry Pi 4) with:
  - Model compression
  - Lightweight U-Net variants
  - Hardware acceleration (GPUs, FPGAs)

---

## 9. Key Contributions

1. **Novel 5D Hyperchaotic Map**:
   - Lyapunov exponents confirm hyperchaotic behavior
   - Kolmogorov entropy (2.9469) - highest among compared methods
   - Passes all 16 NIST SP 800-22 randomness tests

2. **U-Net-Based Dynamic Key Generation**:
   - Critical region segmentation for image-specific keys
   - Unique initial conditions for each image
   - Balanced accuracy (0.9606) and efficiency (25-35% faster than Attention U-Net)

3. **Two-Stage Permutation-Diffusion**:
   - Zig-zag scrambling + 5D chaotic permutation
   - Dynamic DNA flip + DNA XOR diffusion
   - Strong avalanche effect (NPCR >99.6%, UACI >33%)

4. **Comprehensive Security**:
   - Correlation ≤ |0.002|
   - Entropy ≥ 7.9971
   - Chi-square PASS at 5% and 1%
   - Key space 2⁵⁰⁰
   - Encryption time ≈ 0.018 s per pixel on GPU

5. **Robust Against Attacks**:
   - Cropping attacks (5%-25%)
   - Noise attacks (salt-pepper, speckle)
   - Geometric attacks (rotation, translation, scaling)
   - Differential attacks
   - Brute-force attacks

---

## 10. Advantages & Limitations

### Advantages
✅ **Extremely large key space** (2⁵⁰⁰) prevents brute-force attacks  
✅ **Dynamic key generation** - unique keys for each image  
✅ **Near-ideal entropy** (7.9971) ensures maximum randomness  
✅ **Strong avalanche effect** - NPCR >99.6%, UACI >33%  
✅ **Fast encryption** (~2.93s per 256×256 image)  
✅ **Robust segmentation** with U-Net (IoU=0.6821, Dice=0.8110)  
✅ **Resistant to multiple attack types** (cropping, noise, geometric, differential)  
✅ **Real-time capability** suitable for telemedicine  

### Limitations
⚠️ **Limited to 2D images** - not tested on 3D medical data (MRI, CT volumes)  
⚠️ **Not tested on video streams** (e.g., ultrasound videos)  
⚠️ **Requires GPU for fast U-Net inference** (0.03s on Tesla T4)  
⚠️ **Segmentation quality affects key generation** - failure modes not fully explored  
⚠️ **Cross-platform execution** (GPU for segmentation, CPU for encryption) may be impractical  
⚠️ **No quantum-resistant mechanisms** - vulnerable to future quantum attacks  

---

## 11. Future Scope

1. **3D Medical Data Encryption**:
   - Extend to volumetric data (MRI, CT scans) using 3D U-Net
   - Preserve depth-wise structures

2. **Real-Time Video Encryption**:
   - Adapt for medical video streams (ultrasound, endoscopy)
   - Lightweight segmentation and fast chaos-based operations

3. **Post-Quantum Cryptography**:
   - Integrate lattice-based or code-based cryptography
   - Ensure resilience against quantum attacks

4. **Advanced Deep Learning Models**:
   - Explore attention mechanisms, transformers for key generation
   - Generate more complex, anatomically-aware keys

5. **Embedded Platform Deployment**:
   - Optimize for medical IoT devices (Raspberry Pi, Jetson Nano)
   - Model compression, fixed-point implementation

6. **Cloud & Telemedicine Integration**:
   - Real-time encryption for cloud storage
   - Secure patient data management in telemedicine platforms

---

## 12. Conclusion

This research successfully demonstrates a **highly secure and efficient medical image encryption scheme** by combining:
- **Novel 5D hyperchaotic map** with superior randomness properties
- **U-Net deep learning segmentation** for dynamic key generation
- **Two-stage permutation-diffusion** with dynamic DNA encoding

**Quantitative Achievements**:
- Correlation coefficients ≤ |0.002| (all directions)
- Shannon entropy ≥ 7.9971 (near-ideal)
- NPCR ≥ 99.61%, UACI ≥ 33.49% (optimal differential attack resistance)
- Key space 2⁵⁰⁰ (largest among compared methods)
- Encryption time ~2.93s per 256×256 image (real-time capable)

**Security Validation**:
- ✅ Passes all NIST randomness tests
- ✅ Resistant to cropping, noise, geometric attacks
- ✅ High key sensitivity (10⁻⁶ change prevents decryption)
- ✅ Chi-square test PASS at both 5% and 1% significance

The proposed method **outperforms existing techniques** in correlation reduction, entropy maximization, and key space expansion while maintaining computational efficiency suitable for **real-world medical applications, telemedicine, and secure patient data management**.

---

## References & Datasets

**Publicly Available Datasets Used**:
- RITE (Retinal Images for Vessel Extraction)
- DRIVE (Digital Retinal Images)
- BRATS2020 (Brain Tumor Segmentation)
- Breast Ultrasound Images Dataset
- GlaS (Gland Segmentation Dataset)
- Chest X-ray Dataset

**Key References**: 58 cited works covering chaotic systems, medical image encryption, deep learning segmentation, DNA encoding, and security analysis.

---

## Keywords

Hyper-chaotic map, Image encryption, Dynamic DNA encoding, Critical region segmentation, U-Net, Zig-zag scrambling, Medical image security, Differential attack, NPCR, UACI, Entropy analysis, Lyapunov exponents, Kolmogorov entropy, NIST test
